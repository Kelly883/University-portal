# Next.js System Rebuild Plan

## 1. Project Restructuring

* **Objective**: Move existing Django codebase to a legacy directory and initialize a fresh Next.js application in the root.

* **Actions**:

  * Create `legacy_django/` directory.

  * Move all Django apps, configuration, and templates into `legacy_django/`.

  * Initialize Next.js 14+ (App Router) in the root directory.

## 2. Tech Stack Installation

* **Objective**: Install and configure the requested technologies.

* **Dependencies**:

  * **Core**: `next`, `react`, `react-dom`

  * **Language**: `typescript`, `@types/node`, `@types/react`

  * **Styling**: `tailwindcss`, `postcss`, `autoprefixer`

  * **Database**: `prisma`, `@prisma/client`

  * **Auth**: `next-auth@beta` (Auth.js v5) or `next-auth` (v4) - *Will use v5 for latest App Router support.*

  * **Utilities**: `@upstash/redis`, `openai`, `bcryptjs`

  * **Payments**: `flutterwave-node-v3`, `paystack-sdk` (or axios wrappers)

## 3. Database Schema Translation (Django -> Prisma)

* **Objective**: Recreate the data model using Prisma Schema.

* **Models to Translate**:

  * `User` (with Roles: Admin, Faculty, Student, Parent)

  * `Profile` (One-to-One with User)

  * `Department` & `Course` (Relations: Course belongs to Dept, Course has Faculty)

  * `Enrollment` (Student-Course Many-to-Many via explicit model)

  * `CourseMaterial` (One-to-Many from Course)

  * `Attendance` (Tracking student presence)

  * `Exam` & `Result` (Grading system)

  * `Notification` (System alerts)

## 4. Authentication & Access Control

* **Objective**: Implement secure, role-based authentication.

* **Implementation**:

  * **NextAuth Config**: Credentials Provider (for email/password) + Prisma Adapter.

  * **Session Handling**: JWT-based sessions (stateless, suitable for Vercel serverless).

  * **Middleware**: `middleware.ts` to protect routes (e.g., `/admin/*` only for Admins, `/dashboard/*` for authenticated users).

  * **RBAC**: Custom utility functions to check user roles in Server Components/Actions.

## 5. Development Roadmap

* **Step 1**: Clean up and Init Next.js.

* **Step 2**: Define `schema.prisma` and generate client.

* **Step 3**: Setup `auth.ts` (NextAuth) and `middleware.ts`.

* **Step 4**: Create folder structure (`app/(dashboard)`, `app/api`, `components`, `lib`).

* **Step 5**: Commit to GitHub to trigger Vercel (clean slate).

## Note on Data

* This is a *rebuild*. Existing data in the local SQLite/Postgres (Django managed) will need to be migrated manually if required later. We will start with a fresh schema push.

