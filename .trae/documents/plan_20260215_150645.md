# Phase 2: Pages & API Implementation Plan

## 1. Analysis
*   **Goal**: Build out the complete page structure and backend API routes for the Titan University portal.
*   **Scope**:
    *   **Pages**: Login (done), Profile, Dashboard sub-pages (Courses, Grades, Payments, Notifications).
    *   **API**: RESTful endpoints for Users, Courses, Enrollments, Grades, Payments, Notifications.
*   **Tech Stack**: Next.js App Router, Prisma, Zod (validation), NextAuth (protection).

## 2. API Implementation Strategy (`src/app/api`)
I will create the following route handlers using standard Next.js App Router conventions (`route.ts`):
*   `/api/users`: GET (list), POST (create). Admin only.
*   `/api/courses`: GET (list), POST (create). Admin/Faculty.
*   `/api/enrollments`: POST (enroll), DELETE (unenroll).
*   `/api/grades`: GET (list), POST (update).
*   `/api/payments`: GET (history), POST (pay).
*   `/api/notifications`: GET (list), PATCH (mark read).

*Validation*: I will create a `src/lib/validations` folder to store Zod schemas shared between client and server.

## 3. Page Implementation Strategy (`src/app/(dashboard)`)
I will update the existing placeholder pages to fetch data from these new APIs (or directly via Server Actions/Prisma for better performance in Server Components).
*   **Student**:
    *   `/student/courses`: List enrolled courses.
    *   `/student/grades`: View grades.
    *   `/student/payments`: Payment history & pay button.
*   **Faculty**:
    *   `/faculty/courses`: List taught courses.
    *   `/faculty/grading`: Grade submission interface.
*   **Admin**:
    *   `/admin/users`: User management table.
    *   `/admin/courses`: Course creation form.

## 4. Execution Steps
1.  **Validation Schemas**: Create `src/lib/schemas.ts` for Zod definitions.
2.  **API Routes**: Implement the 6 core API endpoints with role checks.
3.  **Page Components**: Build the UI for the dashboard sub-pages using the components created in Step 3.
4.  **Integration**: Connect the pages to the data (using Server Components where possible for initial load).

## Refinement
*   Instead of raw `fetch` in Client Components, I will prioritize **Server Actions** or direct **Prisma calls in Server Components** for data fetching to ensure type safety and performance, as is best practice in Next.js 14. However, I will still expose the API routes as requested for external/client-side flexibility.

## Execution Order
1.  Create Zod schemas.
2.  Create API routes.
3.  Implement Admin Pages (Users, Courses).
4.  Implement Faculty Pages (Courses, Grading).
5.  Implement Student Pages (Courses, Grades, Payments).
